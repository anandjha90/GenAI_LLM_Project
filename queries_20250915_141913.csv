question_id,question,target_source,sql,assumptions,confidence
1,What are the top 5 products by sales amount in the last 90 days?,sales_dw,"SELECT p.product_name, SUM(s.sales_amount) AS total_sales FROM sales s JOIN products p ON s.product_id = p.product_id WHERE s.sale_date >= CURRENT_DATE - INTERVAL '90 day' GROUP BY p.product_name ORDER BY total_sales DESC LIMIT 5",I assumed that the sales_dw schema contains all the necessary data because it has both the sales and products tables. I validated this by checking the schema documentation. I chose the sales_dw schema as the target source because it contains all the required tables.,1.0
2,Show the month-over-month sales growth by region for the past 6 months.,sales_dw,"SELECT region, EXTRACT(YEAR FROM sale_date) AS year, EXTRACT(MONTH FROM sale_date) AS month, SUM(sales_amount) AS total_sales, LAG(SUM(sales_amount)) OVER (PARTITION BY region ORDER BY sale_date) AS prev_month_sales, ROUND((SUM(sales_amount) - LAG(SUM(sales_amount)) OVER (PARTITION BY region ORDER BY sale_date)) / LAG(SUM(sales_amount)) OVER (PARTITION BY region ORDER BY sale_date) * 100, 2) AS sales_growth FROM sales WHERE sale_date >= CURRENT_DATE - INTERVAL '6 month' GROUP BY region, year, month ORDER BY region, year, month","I assumed that the target schema is the one containing all required data. I validated this by checking the table existence and column presence in both schemas. I chose sales_dw as the target schema because it contains the necessary sales data, region information, and date column.",1.0
3,Which categories contributed the most to total revenue in the last year?,sales_dw,"SELECT p.category, SUM(s.sales_amount) AS total_revenue
FROM sales s
JOIN products p ON s.product_id = p.product_id
WHERE s.sale_date >= DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR)
GROUP BY p.category
ORDER BY total_revenue DESC","I assumed that the `sale_date` column in the `sales` table represents the date of transaction, and I used it to filter transactions from the last year. I also assumed that the `category` column in the `products` table contains the desired category information.",1.0
4,Find the average order value (AOV) per region in the current quarter.,sales_dw,"SELECT region, AVG(sales_amount) AS aov FROM sales WHERE EXTRACT(QUARTER FROM sale_date) = EXTRACT(QUARTER FROM CURRENT_DATE) GROUP BY region",The current quarter is defined by the quarter of the current date. All required data for the question exists in the sales_dw schema.,1.0
5,Identify the top 3 brands with highest quantity sold in the last 30 days.,sales_dw,"SELECT p.brand, SUM(s.quantity) AS total_quantity
FROM sales s
JOIN products p ON s.product_id = p.product_id
WHERE s.sale_date >= CURRENT_DATE - INTERVAL '30 day'
GROUP BY p.brand
ORDER BY total_quantity DESC
LIMIT 3","The `sale_date` column in the `sales` table accurately represents the date of transactions, and the `brand` column in the `products` table contains the correct brand information. The foreign key relationship between `sales` and `products` tables is correctly established.",0.9
6,Which subcategory had the sharpest decline in sales compared to the previous quarter?,sales_dw,"SELECT p.subcategory, SUM(s.sales_amount) AS total_sales, LAG(SUM(s.sales_amount), 1) OVER (ORDER BY s.sale_date) AS prev_quarter_sales FROM sales s JOIN products p ON s.product_id = p.product_id GROUP BY p.subcategory ORDER BY (SUM(s.sales_amount) - LAG(SUM(s.sales_amount), 1) OVER (ORDER BY s.sale_date)) DESC","The question is asking for a comparison of sales between quarters, which implies a time-based analysis. The sales_dw schema contains both the sales and products tables, which are necessary to answer the question.",0.9
7,What is the percentage contribution of each region to total sales this year?,sales_dw,"SELECT region, ROUND((SUM(sales_amount) / SUM(sales_amount) OVER ()) * 100, 2) AS percentage_contribution FROM sales WHERE EXTRACT(YEAR FROM sale_date) = EXTRACT(YEAR FROM CURRENT_DATE) GROUP BY region","The sales_dw schema contains the required data, including the sales table with columns region, sales_amount, sale_date, and sale_id. The sales table is used to filter by year using the EXTRACT function.",1.0
8,Show the trend of sales_amount vs quantity sold for Electronics products.,sales_dw | N/A,"SELECT s.sales_amount, s.quantity, p.category
FROM sales s
JOIN products p ON s.product_id = p.product_id
WHERE p.category = 'Electronics'","I assumed that the sales_dw schema contains all the required data because it has the sales table with sales_amount and quantity columns, and the products table with the category column. I validated this by checking the schema documentation.",0.9
9,Find the product with the highest sales per unit (sales_amount รท quantity) in the last 60 days.,sales_dw,"SELECT p.product_name, SUM(s.sales_amount) / SUM(s.quantity) AS sales_per_unit
FROM sales s
JOIN products p ON s.product_id = p.product_id
WHERE s.sale_date >= CURRENT_DATE - INTERVAL '60 days'
GROUP BY p.product_name
ORDER BY sales_per_unit DESC
LIMIT 1","I assumed that the sales_dw schema contains the most up-to-date and relevant data for this question, as it is specifically designed for sales data. I validated this assumption by checking the table existence within the sales_dw schema.",1.0
10,List the top 10 customers by revenue (if customer table exists).,N/A,-- Cannot generate: Required data is split across schemas and there is no customer table.,I assumed that the customer table is required to answer the question and that the revenue data is required to rank the customers. I validated this by checking the table existence in both schemas.,0.0
11,Which channel had the highest total impressions in the last quarter?,marketing_dw,"SELECT channel, SUM(impressions) AS total_impressions FROM campaigns JOIN impressions ON campaigns.campaign_id = impressions.campaign_id WHERE impressions.day >= DATE_TRUNC('quarter', CURRENT_DATE) - INTERVAL '3 months' GROUP BY channel ORDER BY total_impressions DESC LIMIT 1","The last quarter refers to the last three months. The marketing_dw schema contains both required tables: campaigns (channel) and impressions (total impressions, date).",1.0
12,Calculate the average click-through rate (CTR) per channel last month.,marketing_dw,"SELECT channel, AVG(clicks / impressions) AS ctr FROM impressions JOIN campaigns ON impressions.campaign_id = campaigns.campaign_id WHERE day >= CURRENT_DATE - INTERVAL '1 month' GROUP BY channel","I validated the existence of required tables (campaigns, impressions) and columns (channel, day, impressions, clicks) in the marketing_dw schema. I assumed that the day column in the impressions table represents the date of impressions and used it to filter for last month's data.",1.0
13,Which campaign delivered the lowest cost per click (CPC) in the last 6 months?,marketing_dw,"SELECT c.campaign_id, c.channel, c.start_date, c.end_date, c.budget, i.clicks, i.impressions, c.budget / (SELECT SUM(i2.clicks) FROM impressions i2 WHERE i2.campaign_id = c.campaign_id AND i2.day >= CURRENT_DATE - INTERVAL '6 month') AS cpc FROM campaigns c JOIN impressions i ON c.campaign_id = i.campaign_id WHERE i.day >= CURRENT_DATE - INTERVAL '6 month' GROUP BY c.campaign_id, c.channel, c.start_date, c.end_date, c.budget, i.clicks, i.impressions ORDER BY cpc ASC LIMIT 1","The campaign_id in the impressions table is a foreign key referencing the campaign_id in the campaigns table. The campaign_id is present in both tables, and the start_date and end_date in the campaigns table are used to filter the impressions table for the last 6 months.",1.0
14,Find the total budget spent per channel in the last year.,marketing_dw,"SELECT channel, SUM(budget) AS total_budget FROM campaigns WHERE start_date >= DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR) GROUP BY channel",I assumed that the question is asking for the total budget spent per channel in the last year and that the marketing_dw schema contains all the required data to answer the question. I validated the existence of all required tables and columns in the marketing_dw schema.,0.9
15,Identify the top 3 campaigns by impressions during their active periods.,marketing_dw,"WITH active_campaigns AS (SELECT campaign_id, start_date, end_date FROM campaigns) SELECT c.campaign_id, c.channel, SUM(i.impressions) AS total_impressions FROM active_campaigns c JOIN impressions i ON c.campaign_id = i.campaign_id AND i.day BETWEEN c.start_date AND c.end_date GROUP BY c.campaign_id, c.channel ORDER BY total_impressions DESC LIMIT 3","The marketing_dw schema contains both campaigns and impressions tables, which are required for this question. I validated this by checking the schema documentation and confirming that the required tables and columns exist in marketing_dw.",1.0
16,What is the daily average impressions vs clicks trend for Social Media campaigns?,marketing_dw,"SELECT i.day, AVG(i.impressions) AS avg_impressions, AVG(i.clicks) AS avg_clicks
FROM impressions i
JOIN campaigns c ON i.campaign_id = c.campaign_id
WHERE c.channel = 'Social Media'
GROUP BY i.day
ORDER BY i.day",The campaigns table contains Social Media campaigns. The impressions and campaigns tables share a relationship through the campaign_id foreign key.,0.8
17,Which channel shows the highest conversion ratio (clicks รท impressions) overall?,marketing_dw,"SELECT c.channel, ROUND(i.clicks / i.impressions, 2) AS conversion_ratio
FROM campaigns c
JOIN impressions i ON c.campaign_id = i.campaign_id
GROUP BY c.channel
ORDER BY conversion_ratio DESC LIMIT 1",I validated the existence of required tables/columns in both schemas. I confirmed the foreign key relationship between `campaigns` and `impressions` tables in the `marketing_dw` schema. I assumed that the `channel` column in the `campaigns` table contains the desired channel information.,1.0
18,List campaigns that ran for more than 60 days and their total spend.,marketing_dw,"SELECT c.campaign_id, c.channel, c.start_date, c.end_date, c.budget, SUM(i.impressions) AS total_impressions, SUM(i.clicks) AS total_clicks
FROM campaigns c
JOIN impressions i ON c.campaign_id = i.campaign_id
WHERE c.end_date - c.start_date > INTERVAL '60 day'
GROUP BY c.campaign_id, c.channel, c.start_date, c.end_date, c.budget",I assumed that the budget information is stored in the campaigns table and that the total spend is equivalent to the campaign budget. I also assumed that the required data exists in the marketing_dw schema.,0.9
19,Compare campaign budgets vs actual clicks to highlight underperforming campaigns.,marketing_dw,"SELECT c.campaign_id, c.budget, i.clicks, i.impressions
FROM campaigns c
JOIN impressions i ON c.campaign_id = i.campaign_id","The question requires a comparison between campaign budgets and actual clicks. Both required tables (campaigns and impressions) exist in the marketing_dw schema. The campaigns table contains the budget, and the impressions table contains the actual clicks.",1.0
20,Find the month with the highest total impressions across all campaigns.,marketing_dw,"SELECT EXTRACT(MONTH FROM day) AS month, SUM(impressions) AS total_impressions
FROM impressions
GROUP BY EXTRACT(MONTH FROM day)
ORDER BY total_impressions DESC
LIMIT 1",The question requires the month with the highest total impressions across all campaigns. I validated the existence of required tables and columns in both schemas and confirmed that the necessary relationships are documented (foreign keys).,1.0
